<div class="container">
  <div class="mural-header">
    <h1>ğŸ¨ Mural de Mensajes MatemÃ¡ticos ğŸ¨</h1>
    <p>Compartiendo nuestras experiencias con Fundapromat</p>
    <p class="public-notice" *ngIf="!adminUnlocked">
      <i class="fa-solid fa-eye"></i>
      EstÃ¡s viendo el mural en modo pÃºblico
    </p>
  </div>

  <div class="toolbar">
    <a routerLink="/form">
      <button class="ghost">
        <i class="fa-solid fa-arrow-left"></i>
        Volver al Formulario
      </button>
    </a>
    
    <span class="badge" [class.unlocked]="adminUnlocked">
      <i class="fa-solid" [class.fa-lock]="!adminUnlocked" [class.fa-unlock]="adminUnlocked"></i>
      {{ adminHint }}
    </span>
    
    <button class="secondary" (click)="unlock()">
      <i class="fa-solid fa-key"></i>
      Alternar Admin
    </button>
    
    <span class="spacer"></span>
    
    <button class="secondary download-btn" (click)="downloadPNG()" title="Descargar mural como imagen">
      <i class="fa-solid fa-download"></i>
      Descargar PNG
    </button>
    
    <button class="danger" *ngIf="adminUnlocked" (click)="clearAll()" title="Borrar todo el mural">
      <i class="fa-solid fa-trash"></i>
      Limpiar Todo
    </button>
  </div>

  <div class="stats-bar" *ngIf="items && items.length > 0">
    <div class="stat-item">
      <i class="fa-solid fa-images"></i>
      <span>{{ items.length }} {{ items.length === 1 ? 'mensaje' : 'mensajes' }}</span>
    </div>
  </div>

  <div id="muralContainer" class="grid">
    <div class="card" *ngFor="let it of items || []; let i = index" [style.animation-delay]="(i * 0.05) + 's'">
      <img *ngIf="it?.photoUrl" 
           [src]="it.photoUrl" 
           [alt]="it?.name || 'foto'" 
           loading="lazy"
           crossorigin="anonymous">
      
      <div class="card-content">
        <div class="name">
          <i class="fa-solid fa-user-circle"></i>
          <div class="name-text">
            <span class="person">{{ it?.name }}</span>
            <small class="country" *ngIf="it?.country">Desde {{ it.country }}</small>
          </div>
        </div>

        <div class="msg">{{ it?.message }}</div>
        
        <small *ngIf="toDate(it?.createdAt) as d" class="date">
          <i class="fa-regular fa-clock"></i>
          {{ d | date:'short' }}
        </small>
      </div>
      
      <button 
        class="danger delete-btn" 
        *ngIf="adminUnlocked" 
        (click)="remove(it)"
        title="Eliminar esta publicaciÃ³n">
        <i class="fa-solid fa-trash"></i>
        Borrar
      </button>
    </div>
  </div>

  <div class="empty-state" *ngIf="!items || items.length === 0">
    <i class="fa-solid fa-inbox"></i>
    <h3>No hay mensajes aÃºn</h3>
    <p>Â¡SÃ© el primero en compartir tu experiencia!</p>
    <a routerLink="/form">
      <button>
        <i class="fa-solid fa-plus"></i>
        Crear Primer Mensaje
      </button>
    </a>
  </div>
</div>